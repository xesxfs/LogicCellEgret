var egret=window.egret,__reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))(function(o,r){function i(e){try{c(a.next(e))}catch(t){r(t)}}function s(e){try{c(a["throw"](e))}catch(t){r(t)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}c((a=a.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return a([e,t])}}function a(n){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(i=r[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,r=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(i=c.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){c.label=n[1];break}if(6===n[0]&&c.label<i[1]){c.label=i[1],i=n;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(n);break}i[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(a){n=[6,a],r=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,r,i,s,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},Effect=function(e){function t(){var t=e.call(this)||this;return t.frameCnt=0,t.doDraw=!1,t}return __extends(t,e),t.prototype.drawBorderRect=function(e,t,n,a,o,r){this.graphics.clear(),this.graphics.beginFill(0,0),this.graphics.lineStyle(o,this.color),this.graphics.drawRect(0,0,n,a),this.graphics.endFill()},t.prototype.update=function(){return!1},t}(egret.Sprite);__reflect(Effect.prototype,"Effect");var Input=function(e){function t(){var t=e.call(this)||this;return t.percentWidth=100,t.percentHeight=100,t.addEventListener("touchBegin",t.mouseDownEvent,t),t.addEventListener("touchEnd",t.mouseUpEvent,t),t.addEventListener("touchMove",t.mouseMoveEvent,t),t.addEventListener("touchReleaseOutside",t.mouseOutEvent,t),t}return __extends(t,e),t.prototype.mouseDownEvent=function(e){},t.prototype.mouseUpEvent=function(e){},t.prototype.mouseOutEvent=function(e){},t.prototype.mouseMoveEvent=function(e){},t}(eui.Group);__reflect(Input.prototype,"Input");var Scene=function(e){function t(){var t=e.call(this)||this;return t.percentHeight=100,t.percentWidth=100,t}return __extends(t,e),t.prototype.update=function(){},t}(eui.Component);__reflect(Scene.prototype,"Scene");var StageData=function(){function e(e){this.packNo=0,this.stageNo=0,this.star3=0,this.star2=0,this.fieldW=0,this.fieldH=0,this.backGroundColor=0,this.stageString=e,this.convert()}return e.prototype.convert=function(){var e=null;e=this.stageString.split(","),this.star3=~~parseInt(e[0]),this.stageNo=~~parseInt(e[1]),this.stageName=e[2],this.fieldW=~~parseInt(e[3]),this.fieldH=~~parseInt(e[4]),this.fieldData=e[5],this.vecBlockData=new Array;for(var t=6;t<e.length;)this.vecBlockData.push(e[t]),t++},e}();__reflect(StageData.prototype,"StageData");var Game=function(e){function t(){var t=e.call(this)||this;return t.percentHeight=100,t.percentWidth=100,t.addChild(SceneManager),t.addChild(InputManager),SceneManager.newScene(new SelectScene),t.addEventListener(egret.Event.ENTER_FRAME,t.ent,t),t}return __extends(t,e),t.prototype.ent=function(e){SceneManager.scene.update()},t}(eui.Component);__reflect(Game.prototype,"Game");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,a){function o(e){t.call(a,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),n.call(a))}var i=this;"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(a,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.bin",function(e,n){window.JSONParseClass.setData(e),o(e),egret.callLater(function(){t.call(a,generateEUI2)},i)},this,RES.ResourceItem.TYPE_BIN):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT))},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var App=function(){function e(){}return e.startUp=function(t){console.log("startUp");var n=new eui.Rect;n.fillColor=8947848,n.percentWidth=100,n.percentHeight=100,t.addChild(n),e.BackMenu=new BackMenuBitmapClass,t.addChild(new Game)},e}();__reflect(App.prototype,"App");var EffectLayerErase=function(e){function t(t,n,a){var o=e.call(this)||this;return o.onComPlete=!1,o.endCnt=25,o.x=t,o.y=n,o.color=a,o.drawBorderRect(0,0,120,120,10,o.color),o.x=t+(o.width>>1),o.y=n+(o.height>>1),o.anchorOffsetX=o.width>>1,o.anchorOffsetY=o.height>>1,o.start(),o}return __extends(t,e),t.prototype.update=function(){return this.onComPlete},t.prototype.start=function(){var e=this;egret.Tween.get(this).to({scaleX:6,scaleY:6},10*this.endCnt).call(function(){e.onComPlete=!0})},t}(Effect);__reflect(EffectLayerErase.prototype,"EffectLayerErase");var EffectManagerClass=function(e){function t(){var t=e.call(this)||this;return t.vecEffect=[],t}return __extends(t,e),t.prototype.update=function(){var e=0,t=null,n=this.vecEffect.length;for(e=0;n>e;)t=this.vecEffect[e],t.update()&&(console.log("removeEffect"),EffectManager.removeEffect(e),e--,n--),e++},t.prototype.addEffect=function(e){e.effectNumber=this.vecEffect.length,this.vecEffect.push(e),this.addChild(e)},t.prototype.removeEffect=function(e){var t=this.vecEffect.splice(e,1);if(t){this.vecEffect.length;this.removeChild(t[0])}},t}(egret.Sprite);__reflect(EffectManagerClass.prototype,"EffectManagerClass");var EffectManager=new EffectManagerClass,LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var InputManagerClass=function(e){function t(){var t=e.call(this)||this;return t.percentWidth=100,t.percentHeight=100,t}return __extends(t,e),t.prototype.newInput=function(e){this.removeChildren(),this.input=e,null!=e&&this.addChild(e)},t}(eui.Component);__reflect(InputManagerClass.prototype,"InputManagerClass");var InputManager=new InputManagerClass,Resource=function(){function e(){return e.Instance?e.Instance:void 0}return e.getBlockChips=function(e,t,n,a){void 0===n&&(n=44),void 0===a&&(a=44),this.ChipsSpriteSheet||(this.ChipsSpriteSheet=new egret.SpriteSheet(RES.getRes("Chip_png")));var o=this.ChipsSpriteSheet.getTexture(e+"_"+t);return o||(this.ChipsSpriteSheet.createTexture(e+"_"+t,e,t,n,a),o=this.ChipsSpriteSheet.getTexture(e+"_"+t)),new eui.Image(o)},e.getMusic=function(){return this.sounds||(this.sounds=[RES.getRes("SoundC_mp3"),RES.getRes("SoundD_mp3"),RES.getRes("SoundE_mp3"),RES.getRes("SoundF_mp3"),RES.getRes("SoundG_mp3"),RES.getRes("SoundA_mp3"),RES.getRes("SoundB_mp3"),RES.getRes("SoundCC_mp3")],this.sounds.forEach(function(e){e.type=egret.Sound.EFFECT})),this.sounds},e.Instance=new e,e}();__reflect(Resource.prototype,"Resource");var Main=function(e){function t(){var t=e.call(this)||this;return SharedManager.init(),t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),console.log("createChildren"),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return console.log("runGame"),[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:console.log("loadResource"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 2:return t.sent(),[4,this.loadTheme()];case 3:return t.sent(),[4,RES.loadGroup("preload",0)];case 4:return t.sent(),[3,6];case 5:return e=t.sent(),console.error(e),[3,6];case 6:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,n){var a=new eui.Theme("resource/default.thm.json",e.stage);a.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){console.log("createGameScene"),App.startUp(this)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var SceneManagerClass=function(e){function t(){var t=e.call(this)||this;return t.percentHeight=100,t.percentWidth=100,t}return __extends(t,e),t.prototype.newScene=function(e){this.nextScene=e,null!=this.scene?egret.Tween.get(this.scene).to({alpha:0},300,egret.Ease.elasticOut).call(this.next,this):this.next()},t.prototype.next=function(){var e=0;this.removeChildren(),this.scene=null,this.scene=this.nextScene,this.scene instanceof SetPuzzleScene?e=0:this.scene instanceof SetScoreScene?e=1:this.scene instanceof SetScore30Scene?(SetScore30Scene.cnt=30,SetScore30Scene.isFinish=!1,e=2):this.scene instanceof SetScore1minScene?(SetScore1minScene.cnt=-95,SetScore1minScene.isFinish=!1,e=3):this.scene instanceof SetScore1comboScene&&(SetScore1comboScene.isFinish=!1,e=4),Status.reset(e),this.nextScene.alpha=0,egret.Tween.get(this.nextScene).to({alpha:1},200,egret.Ease.elasticOut),this.addChild(this.scene)},t}(eui.Component);__reflect(SceneManagerClass.prototype,"SceneManagerClass");var SceneManager=new SceneManagerClass,SharedManagerClass=function(){function e(){this.vecPuzzleClear=[],this.score=0,this.score1min=0,this.score30=0,this.score1combo=0,this.userName="usercc",this.sound=!0,this.sendScoreTime=0,this.sendScore30Time=0,this.sendScore1minTime=0,this.sendScore1comboTime=0,this.dayScore=0,this.dayScore30=0,this.dayScore1min=0,this.dayScore1combo=0,this.titles=[["[有人@我]：智商超200的快来玩这游戏！","resource/assets/images/Icon48.png"],["凭智商玩的得好，为什么要停下来","resource/assets/images/Icon48.png"],["这游戏也太虐了，我为什么要点进来…","resource/assets/images/Icon48.png"],["300分（分值），我不是针对谁，在座的各位都玩不过我~","resource/assets/images/Icon48.png"],["据说只有1%的人能上300分（分值），需要超强逻辑","resource/assets/images/Icon48.png"],["战五渣们，来看看你们的逻辑分数吧","resource/assets/images/Icon48.png"]]}return e.getInstance=function(){return!this.instance&&(this.instance=new e),this.instance},e.prototype.init=function(){try{this.showShareMenu(),this.getUpdateManager(),this.getPuzzleClearNum(),this.getScore(),this.getScore30(),this.getScore1combo(),this.getScore1min(),console.log("init:",this.score,this.score30,this.score1min,this.score1combo)}catch(e){console.error(e)}},e.prototype.getPuzzleClearNum=function(){for(var e=this.getItem("puzzle"),t=0;25>t;)this.vecPuzzleClear.push(0),t++;if(e)for(var n=e.split(","),a=0;a<n.length;a++)this.vecPuzzleClear[a]=parseInt(n[a],10);this.setItem("puzzle",this.vecPuzzleClear.toString())},e.prototype.getCurPuzzle=function(){for(var e=0,t=0;t<this.vecPuzzleClear.length;t++)if(0===this.vecPuzzleClear[t]){e=t;break}return e},e.prototype.getScore=function(){var e=this.getItem("score");e&&""!=e||(e="0");try{this.score=parseInt(e,10)}catch(t){}},e.prototype.getScore30=function(){var e=this.getItem("score30");e&&""!=e||(e="0");try{this.score30=parseInt(e,10)}catch(t){}},e.prototype.getScore1min=function(){var e=this.getItem("score1min");e&&""!=e||(e="0");try{this.score1min=parseInt(e,10)}catch(t){}},e.prototype.getScore1combo=function(){var e=this.getItem("score1combo");e&&""!=e||(e="0");try{this.score1combo=parseInt(e,10)}catch(t){}},e.prototype.getPerfect=function(){},e.prototype.saveVecPuzzleClear=function(){this.setItem("puzzle",this.vecPuzzleClear.toString())},e.prototype.saveScore=function(e){this.score<e&&(this.score=e,this.setItem("score",e))},e.prototype.saveScore30=function(e){this.score30<e&&(this.score30=e,this.setItem("score30",e))},e.prototype.saveScore1min=function(e){this.score1min<e&&(this.score1min=e,this.setItem("score1min",e))},e.prototype.saveScore1combo=function(e){this.score1combo<e&&(this.score1combo=e,this.setItem("score1combo",e))},e.prototype.saveUserName=function(e){this.userName=e,this.setItem("userName",e)},e.prototype.soundChange=function(){this.sound=!this.sound},e.prototype.erase=function(){egret.localStorage.clear()},e.prototype.parseItem2Number=function(e){var t=0;return this.getItem(e)&&(this.score=parseInt(this.getItem(e))),t},e.prototype.getItem=function(e){var t=egret.localStorage.getItem(e);return t},e.prototype.setItem=function(e,t){"number"==typeof t&&(t=t.toString()),egret.localStorage.setItem(e,t),"puzzle"===e&&(t=this.getCurPuzzle().toString()),platform.uploadWXData(e,t)},e.prototype.showShareMenu=function(){var e=this;platform.showShareMenu({withShareTicket:!1}),platform.onShareAppMessage(function(){var t=~~(Math.random()*(e.titles.length-1));return{title:e.titles[t][0],imageUrl:e.titles[t][1],query:""}})},e.prototype.shareAppMessage=function(){var e=~~(Math.random()*(this.titles.length-1));platform.shareAppMessage({title:this.titles[e][0],imageUrl:this.titles[e][1],query:""})},e.prototype.getUpdateManager=function(){var e=platform.getUpdateManager();e&&(e.onCheckForUpdate(function(e){console.log("是否有版本更新：",e.hasUpdate)}),e.onUpdateReady(function(){e.applyUpdate()}),e.onUpdateFailed(function(){}))},e.prototype.postMessage=function(e){platform.openDataContext.postMessage(e)},e}();__reflect(SharedManagerClass.prototype,"SharedManagerClass");var SharedManager=new SharedManagerClass,SoundManager=function(){function e(){}return e}();__reflect(SoundManager.prototype,"SoundManager");var BackMenuBitmapClass=function(e){function t(){var t=e.call(this)||this;return t.cnt=0,t.updateFlag=!1,t.toY=517,t.skinName="BackMenuSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.backMenuGroup.y=-this.toY},t.prototype.updateStart=function(){this.updateFlag||(egret.Tween.removeTweens(this.backMenuGroup),egret.Tween.get(this.backMenuGroup).to({y:this.toY},200,egret.Ease.cubicOut),this.cnt=0,this.updateFlag=!0)},t.prototype.updateFinish=function(){this.updateFlag&&(egret.Tween.removeTweens(this.backMenuGroup),egret.Tween.get(this.backMenuGroup).to({y:-this.toY},200,egret.Ease.quadIn),this.cnt=0,this.updateFlag=!1)},t.prototype.update=function(){this.updateFlag&&(this.backGrogress.width=10*this.cnt,40===this.cnt++&&(this.updateFinish(),SceneManager.newScene(new SelectScene)))},t}(eui.Component);__reflect(BackMenuBitmapClass.prototype,"BackMenuBitmapClass");var BitmapDisplay=function(e){function t(t,n,a){var o=e.call(this)||this;return o.drawRect(t,n,a),o}return __extends(t,e),t.prototype.drawRect=function(e,t,n){this.graphics.beginFill(n),this.graphics.drawRect(0,0,e,t),this.graphics.endFill()},t.prototype.drawBorderRect=function(e,t,n,a,o,r,i){},t.prototype.drawString=function(e,t,n,a){this.text||(this.text=new eui.Label),this.text.text=e,this.text.textColor=a,this.addChild(this.text)},t}(egret.Sprite);__reflect(BitmapDisplay.prototype,"BitmapDisplay");var Block=function(e){function t(){var t=e.call(this)||this;return t.drawPhase=8,t.gridX=0,t.gridY=0,t.inventoryNumber=0,t.removeFlag=!1,t.vecLayer=new Array,t}return __extends(t,e),t.prototype.setLayer=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=0,a=~~e.length;for(n=0;a>n;)this.vecLayer.push(~~e[n]),n++},t.prototype.removeLayer=function(){this.removeFlag=!1,this.drawPhase=3;var e;return e=this.localToGlobal(this.x,this.y),EffectManager.addEffect(new EffectLayerErase(e.x,e.y,t.COLOR[this.vecLayer[0]])),this.vecLayer.shift(),0!=this.vecLayer.length?(this.draw(),!1):(this.destroy(),!0)},t.prototype.destroy=function(){BlockManager.removeBlock(this)},t.prototype.draw=function(){var e=0,t=this.vecLayer.length;if(9!=this.drawPhase)for(this.drawPhase++,this.removeChildren(),e=0;t>e;){var n=Resource.getBlockChips(44*(5*(2-e)+this.drawPhase),44*this.vecLayer[e]);n.width=120,n.height=120,this.addChild(n),e++}},t.prototype.update=function(){this.draw()},t.COLOR=[4738303,16724016,3669832,16777012,16740095],t}(eui.Component);__reflect(Block.prototype,"Block");var BlockManagerClass=function(e){function t(){var t=e.call(this)||this;return t.mouseX=0,t.mouseY=0,t.inventoryPadding=20,t.tidy(),t}return __extends(t,e),t.prototype.reset=function(e){this.removeChildren(),this.vecBlock=new Array,this.vecInventoryBlock=[null,null,null,null,null],this.vec2UndoString=[],this.field=e,this.inventoryPadding=0},t.prototype.tidy=function(){this.bottom=150,this.horizontalCenter=0},t.prototype.update=function(){var e=0,t=this.vecBlock.length;for(e=0;t>e;)this.vecBlock[e].update(),e++;null!=this.mouseDownBlock&&(this.mouseDownBlock.x=BlockManager.mouseX-60,this.mouseDownBlock.y=BlockManager.mouseY-60)},t.prototype.addBlock=function(e){this.vecBlock.push(e),this.addChildAt(e,e.inventoryNumber)},t.prototype.AddAllBlock=function(e,t){void 0===t&&(t=!0);var n=0,a=0,o=null,r=null,i=0,s=0,c=e.length;for(t&&c--,n=0;c>n;){for(o=e[n],i=parseInt(o.charAt(0)),s=parseInt(o.charAt(1)),r=new Block,a=2;a<o.length;)r.vecLayer.push(parseInt(o.charAt(a))),a++;9==i?this.addInventoryBlock(r,s):(this.field.getGrid(s,i).setBlock(r),this.vecBlock.push(r)),r.draw(),n++}for(;this.vecInventoryBlock.length<5;)this.vecInventoryBlock.push(null);t&&(Status.score=parseInt(e[n]),Status.drawScore=Status.score)},t.prototype.addInventoryBlock=function(e,t){for(;this.vecInventoryBlock.length<t;)this.vecInventoryBlock.push(null);this.vecInventoryBlock[t]=e,e.x=125*t,e.inventoryNumber=t,this.addChild(e)},t.prototype.addRandomInventoryBlock=function(e){var t=new Block;t.inventoryNumber=e,this.addInventoryBlock(t,e),1==Status.mode?t.setLayer(5*Math.random(),5*Math.random(),5*Math.random(),5*Math.random()):2==Status.mode?t.setLayer(4*Math.random(),4*Math.random(),4*Math.random(),4*Math.random()):3==Status.mode?t.setLayer(3*Math.random(),3*Math.random(),3*Math.random(),3*Math.random()):4==Status.mode&&t.setLayer(5*Math.random(),5*Math.random(),5*Math.random(),5*Math.random()),t.draw()},t.prototype.removeBlock=function(e){var t=0,n=this.vecBlock.length;for(t=0;n>t;){if(e===this.vecBlock[t]){this.vecBlock.splice(t,1),e.parent&&e.parent.removeChild(e),this.field.getGrid(e.gridX,e.gridY).block=null;break}t++}},t.prototype.mouseDownInventory=function(e){if(!(this.vecInventoryBlock.length<=e)){var t=this.vecInventoryBlock[e];if(null!=t){this.mouseDownBlock=t;var n=this.localToGlobal(t.x,t.y);t.x=n.x,t.y=n.y,this.parent.addChild(t)}}},t.prototype.mouseUp=function(){if(null!=this.mouseDownBlock){var e=this.globalToLocal(this.mouseDownBlock.x,this.mouseDownBlock.y);this.addChildAt(this.mouseDownBlock,this.mouseDownBlock.inventoryNumber),this.mouseDownBlock.x=e.x,this.mouseDownBlock.y=e.y,egret.Tween.get(this.mouseDownBlock).to({x:125*this.mouseDownBlock.inventoryNumber,y:0},100),this.mouseDownBlock=null}},t.prototype.undo=function(){this.field.matchingJob||this.vec2UndoString.length<=1||(this.removeChildren(),this.vecInventoryBlock=[],this.vecBlock=[],this.field.resetGridBlock(),this.AddAllBlock(this.vec2UndoString[this.vec2UndoString.length-2]),this.vec2UndoString.pop(),SceneManager.scene instanceof SetPuzzleScene&&(1===this.vec2UndoString.length?SceneManager.scene.undoBmd.alpha=.2:SceneManager.scene.undoBmd.alpha=.8))},t.prototype.addUndoString=function(){var e=0,t=0,n=null,a=null,o=[];for(e=0;e<this.vecBlock.length;){for(a=this.vecBlock[e],n=""+a.gridY+a.gridX,t=0;t<a.vecLayer.length;)n+=a.vecLayer[t],t++;o.push(n),e++}for(e=0;e<this.vecInventoryBlock.length;){if(a=this.vecInventoryBlock[e],null!=a){for(n="9"+a.inventoryNumber,t=0;t<a.vecLayer.length;)n+=a.vecLayer[t],t++;o.push(n)}e++}0!=this.vec2UndoString.length?o.push(""+Status.score):o.push("0"),this.vec2UndoString.push(o),SceneManager.scene instanceof SetPuzzleScene&&(1==this.vec2UndoString.length?SceneManager.scene.undoBmd.alpha=.2:SceneManager.scene.undoBmd.alpha=.8)},t.prototype.clearCheck=function(){var e=0,t=this.vecInventoryBlock.length;if(0!=this.vecBlock.length)return console.log("clearCheck false length",this.vecBlock),!1;for(e=0;t>e;){if(null!=this.vecInventoryBlock[e])return console.log("clearCheck false"),!1;e++}return InputManager.newInput(null),this.field.stageData.star3<=Status.score?(InputManager.addChild(new ClearSprite(!0)),SharedManager.vecPuzzleClear[this.field.stageData.stageNo-1]=2):(InputManager.addChild(new ClearSprite(!1)),2!=SharedManager.vecPuzzleClear[this.field.stageData.stageNo-1]&&(SharedManager.vecPuzzleClear[this.field.stageData.stageNo-1]=1)),SharedManager.saveVecPuzzleClear(),!0},t.prototype.finishCheck=function(e){return console.log("finishCheck:",this.vecBlock.length,this.vecBlock),9!=this.vecBlock.length?!1:(this.finish(e),!0)},t.prototype.finish=function(e){Status.finishTime=(new Date).getTime();var t=Status.score;switch(Status.mode){case 1:SharedManager.saveScore(t);break;case 2:SharedManager.saveScore30(t),SetScore30Scene.isFinish=!0;break;case 3:SharedManager.saveScore1min(t),SetScore1minScene.isFinish=!0;break;case 4:SharedManager.saveScore1combo(t),SetScore1minScene.isFinish=!0}var n=new ClearSprite(!0,!0);n.retryScene=e,InputManager.addChild(n)},t}(eui.Group);__reflect(BlockManagerClass.prototype,"BlockManagerClass");var BlockManager=new BlockManagerClass,ClearSprite=function(e){function t(t,n){void 0===n&&(n=!1);var a=e.call(this)||this;return a.toY=500,a.isPerfect=t,a.isFinish=n,a.skinName="ClearSpriteSkin",a}return __extends(t,e),t.prototype.childrenCreated=function(){console.log("clearCheck ClearSprite"),this.isPerfect||(this.statusLab.text="清除"),this.isFinish&&(this.statusLab.text="完成",this.nextLab.text="分享"),egret.Tween.get(this.clearGroup).to({y:this.toY},500,egret.Ease.quintOut).wait(100).to({x:66},500,egret.Ease.quintOut),egret.Tween.get(this.menuGroup).wait(600).to({y:this.toY},500,egret.Ease.quintOut),egret.Tween.get(this.retryGroup).wait(800).to({y:this.toY},500,egret.Ease.quintOut),egret.Tween.get(this.nextGroup).wait(1e3).to({y:this.toY},500,egret.Ease.quintOut),this.addEventListener("touchTap",this.onTouch,this)},t.prototype.onTouch=function(e){switch(e.target){case this.clearGroup:break;case this.menuGroup:SceneManager.newScene(new SelectScene);break;case this.retryGroup:this.isFinish?SceneManager.newScene(new this.retryScene):SceneManager.newScene(new SetPuzzleScene(StageManager.getStage(-2)));break;case this.nextGroup:if(this.isFinish)SharedManager.shareAppMessage();else{var t=StageManager.getStage(-1);null!=t&&SceneManager.newScene(new SetPuzzleScene(t))}}},t}(eui.Component);__reflect(ClearSprite.prototype,"ClearSprite");var CountDownSprite=function(e){function t(){var t=e.call(this)||this;return t.percentWidth=100,t.percentHeight=100,t.touchEnabled=!0,t.touchChildren=!1,t.touchThrough=!1,t.drawRect(),t}return __extends(t,e),t.prototype.drawRect=function(){var e=this,t=new eui.Rect(250,120);t.fillColor=11579567,t.horizontalCenter=0,t.verticalCenter=0,this.cdLab=new eui.Label,this.cdLab.text="3",this.cdLab.textColor=0,this.cdLab.horizontalCenter=0,this.cdLab.verticalCenter=0,this.addChild(t),this.addChild(this.cdLab),egret.Tween.get(this).wait(1500).call(function(){e.cdLab.text="2"}).wait(1e3).call(function(){e.cdLab.text="1"}).wait(1e3).call(function(){e.cdLab.text="start"}).to({alpha:0},1e3,egret.Ease.elasticIn).call(function(){e.parent&&e.parent.removeChild(e)})},t}(eui.Group);__reflect(CountDownSprite.prototype,"CountDownSprite");var Field=function(e){function t(n){var a=e.call(this)||this;a.fieldW=0,a.fieldH=0,a.exScore=0;var o=new eui.TileLayout;o.horizontalGap=22,o.verticalGap=18,a.layout=o,a.horizontalCenter=0,a.verticalCenter=0;var r=0,i=0,s=null;for(a.vecSound=Resource.getMusic(),a.stageData=n,o.requestedColumnCount=a.fieldW=n.fieldW,o.requestedRowCount=a.fieldH=n.fieldH,o.requestedColumnCount>=5&&(o.horizontalGap=2),t.fieldX=a.x,t.fieldY=a.y,a.vec2Grid=[];i<a.fieldH;){for(a.vec2Grid.push([]),r=0;r<a.fieldW;)s=new Grid(i,r),s.type=parseInt(a.stageData.fieldData.charAt(r*a.fieldH+i)),a.vec2Grid[i].push(s),1==s.type&&s.drawBroderRect(),a.addChild(s),r++;i++}return console.log(a.vec2Grid),BlockManager.reset(a),BlockManager.AddAllBlock(n.vecBlockData,!1),BlockManager.addUndoString(),a}return __extends(t,e),t.prototype.getGrid=function(e,t){var n=e,a=t;try{return this.vec2Grid[n][a]}catch(o){return null}},t.prototype.matchCheck=function(){var e=0,t=0,n=0,a=null,o=null,r=null,i=null,s=null,c=null,l=0,u=0,h=0;Status.combo++,this.matchingJob=null;var p=!1;for(e=0;e<this.fieldH;){for(t=0;t<this.fieldW;)a=this.vec2Grid[e][t],null!=a.block&&(o=a.block,n=o.vecLayer[0],r=this.getGrid(e+1,t),i=this.getGrid(e,t+1),s=null!=r?r.block:null,c=null!=i?i.block:null,null!=s&&s.vecLayer[0]==n&&(s.removeFlag=!0,o.removeFlag=!0,p=!0),null!=c&&c.vecLayer[0]==n&&(c.removeFlag=!0,o.removeFlag=!0,p=!0)),t++;e++}var d=BlockManager.vecBlock.length;for(e=d-1;e>=0;)o=BlockManager.vecBlock[e],o.removeFlag&&o.removeLayer(),e--;if(p)Status.combo<8?this.vecSound[Status.combo-1].play(0,1):this.vecSound[7].play(0,1),this.matchingJob=egret.Tween.get(this).to({},500).call(this.matchCheck,this);else{if(l=Status.score-this.exScore,u=Status.combo-1,Status.maxCombo<u&&(Status.maxCombo=u),h=Status.mode,u>0)for(Status.combo=Status.combo-1,Status.addScore(),e=0;9>e;)e++;Status.combo=0,h!=GameMode.Puzzle||BlockManager.clearCheck()?h==GameMode.Score?BlockManager.finishCheck(SetScoreScene):h==GameMode.Score30?(0==SetScore30Scene.cnt&&BlockManager.finish(SetScore30Scene),BlockManager.finishCheck(SetScore30Scene)):Status.mode==GameMode.Score1M?BlockManager.finishCheck(SetScore1minScene):Status.mode!=GameMode.ScoreCombo||0==Status.score&&20!=BlockManager.vecBlock.length||BlockManager.finish(SetScore1comboScene):BlockManager.addUndoString()}},t.prototype.mouseUpField=function(e,t){var n=e,a=t,o=this.getGrid(n,a),r=BlockManager.mouseDownBlock;this.matchingJob||null==o||null!=o.block||1!=o.type?BlockManager.mouseUp():(o.setBlock(r),BlockManager.vecInventoryBlock[r.inventoryNumber]=null,BlockManager.vecBlock.push(r),Status.mode>0&&BlockManager.addRandomInventoryBlock(BlockManager.mouseDownBlock.inventoryNumber),2==Status.mode&&SetScore30Scene.cnt--,BlockManager.mouseDownBlock=null,this.exScore=Status.score,this.matchingJob=egret.Tween.get(this).to({},200).call(this.matchCheck,this))},t.prototype.resetGridBlock=function(){for(var e=0,t=0;t<this.fieldH;){for(e=0;e<this.fieldW;)this.vec2Grid[t][e].block&&this.vec2Grid[t][e].removeChildren(),this.vec2Grid[t][e].block=null,e++;t++}},t.fieldX=0,t.fieldY=0,t}(eui.Group);__reflect(Field.prototype,"Field");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function a(a){t.call(n,a,e)}if(RES.hasRes(e)){var o=RES.getRes(e);o?a(o):RES.getResAsync(e,a,this)}else RES.getResByUrl(e,a,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Grid=function(e){function t(t,n){var a=e.call(this)||this;return a.gridX=t,a.gridY=n,a.width=120,a.height=120,a.fillAlpha=0,a.strokeWeight=10,a.strokeAlpha=0,a}return __extends(t,e),t.prototype.setBlock=function(e){this.block=e,e.gridX=this.gridX,e.gridY=this.gridY,e.x=0,e.y=0,this.addChild(e)},t.prototype.drawBroderRect=function(){this.strokeAlpha=1},t}(eui.Rect);__reflect(Grid.prototype,"Grid");var HudManagerScore=function(e){function t(){var t=e.call(this)||this;return t.skinName="HudManagerScoreSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.setGameMode()},t.prototype.setGameMode=function(){var e=Status.mode;e===GameMode.Puzzle?this.timeLab.visible=!1:e===GameMode.Score?(this.stageLab.visible=!1,this.stageNOLab.visible=!1):e===GameMode.Score30?(this.stageLab.visible=!1,this.stageNOLab.visible=!1):e===GameMode.Score1M?(this.stageLab.visible=!1,this.stageNOLab.visible=!1):e===GameMode.ScoreCombo&&(this.stageLab.visible=!1,this.stageNOLab.visible=!1)},t.prototype.update=function(){if(this.scoreLab.text=Status.drawScore.toString(),Status.mode===GameMode.Score1M){var e,t=0,n=0,a=0,o=SetScore1minScene.cnt;o>=0?(o>1800&&(o=1800),e="",t=(1800-o)/30,n=t%60,a=~~(100*t%100),10>n&&(e+="0"),e+=""+~~n+".",10>a&&(e+="0"),e+=""+~~a,this.timeLab.text=e):this.timeLab.text="60.00"}Status.mode===GameMode.Score30&&(this.timeLab.text=SetScore30Scene.cnt.toString())},t}(eui.Component);__reflect(HudManagerScore.prototype,"HudManagerScore");var DebugPlatform=function(){function e(){}return e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.shareAppMessage=function(e){},e.prototype.showShareMenu=function(e){},e.prototype.onShareAppMessage=function(e){},e.prototype.uploadWXData=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.setStorage=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.getStorage=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.getUpdateManager=function(){},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var StageManagerClass=function(){function e(){this.index=0,this.vecStageData=new Array,this.vecStageData.push(new StageData("20,1,testes,2,1,11,900,910")),this.vecStageData.push(new StageData("30,2,testes,3,1,111,901,911,921")),this.vecStageData.push(new StageData("60,3,testes,3,1,111,900,911,9201")),this.vecStageData.push(new StageData("50,4,testes,3,1,111,000,900,911,9210")),this.vecStageData.push(new StageData("220,5,testes,3,2,111011,010,1000,21000,900,9100,92000")),this.vecStageData.push(new StageData("140,6,tes,3,3,010111010,101,212,90001,91002,9201,9302")),this.vecStageData.push(new StageData("400,7,score400,4,4,1111111111111111,0001,2010,1101,3110,0201,2210,1301,3310,9001,9110,9201,9310")),this.vecStageData.push(new StageData("530,8,testes,3,3,010111010,1001,1212,0123,2130,900,9101,92012,930123")),this.vecStageData.push(new StageData("300,9,testes,2,1,11,000,9004,91044,920444,934440,944404")),this.vecStageData.push(new StageData("380,10,testes,2,2,1111,9004,91241,92203,932031")),this.vecStageData.push(new StageData("380,11,testes,2,2,1111,9021,91213,92201,93012,940132")),this.vecStageData.push(new StageData("23180,12,score400,3,4,111110011111,90041,020112,931223,132334,923440,224001,940112,201223,912334,00344")),this.vecStageData.push(new StageData("530,13,tes,5,1,11111,00024,104022,302041,40440,9031,9142,9240,93403,942404")),this.vecStageData.push(new StageData("1260,14,testes,5,1,11111,900,9131,92102,933201,942120")),this.vecStageData.push(new StageData("760,15,tes,3,3,100111100,00424,20002,11313,90042,91432,92130,93420,94340")),this.vecStageData.push(new StageData("590,16,testes,3,1,111,90230,91120,922030,931201,942120")),this.vecStageData.push(new StageData("640,17,tes,2,2,1111,004312,110343,90324,91340,92401,93312,94024")),this.vecStageData.push(new StageData("1290,18,1290,5,1,11111,9012,91113,921132,931123,941312")),this.vecStageData.push(new StageData("1580,19,score400,3,3,001011111,9113,11324,942134,932430,92403,9024")),this.vecStageData.push(new StageData("280,20,tes,5,1,11111,00232,20332,40343,9034,9123,9232,9331,9421")),this.vecStageData.push(new StageData("2070,21,testes,4,4,1111111111111111,0012,1031,2023,3034,3114,3221,3312,2321,1314,0342,0232,0122,9013,9121,9234,9342")),this.vecStageData.push(new StageData("1380,22,score400,3,3,101111101,101423,123241,9023,9131,9241,9342,94213")),this.vecStageData.push(new StageData("2460,23,testes,3,3,111111111,001002,02312,20210,110301,220331,900202,910033,921202,933210,942202")),this.vecStageData.push(new StageData("1770,24,tes,3,3,110111011,00411,01301,21021,22101,90132,91323,92241,93013,94320")),this.vecStageData.push(new StageData("2780,25,testes,3,3,111111111,100324,014130,123424,211214,904213,911334,922124,933240,940144"))
}return e.prototype.getStage=function(e){return-1==e?this.vecStageData.length>this.index+1?(this.index++,this.vecStageData[this.index]):null:-2==e?this.vecStageData[this.index]:(this.index=e,this.vecStageData[this.index])},e}();__reflect(StageManagerClass.prototype,"StageManagerClass");var StageManager=new StageManagerClass,StatusClass=function(){function e(){this.score=0,this.drawScore=0,this.combo=0,this.maxCombo=0,this.mode=0,this.startTime=0,this.finishTime=0,this.vecComboScore=[0,10,20,40,70,110,160,220,290,370,460,560,670,790,920,1060,1210,1370,1540,1720,1910,2110,2320,2540,2770,3010,3260,3520,3790,4070,4360,4660,4970,5290,5620,5960,6310,6670,7040,7420,7810,8210,8620,9040,9470,9910,10360,10820,11290,11770]}return e.prototype.reset=function(e){this.mode=e,this.combo=0,this.maxCombo=this.vecComboScore.length,this.score=0,this.drawScore=0,this.startTime=(new Date).getDate(),this.finishTime=0},e.prototype.addScore=function(){var e=this.vecComboScore[this.combo];return this.score+=e,e},e.prototype.getPlayTime=function(){this.finishTime-this.startTime},e.prototype.update=function(){this.drawScore!=this.score&&(this.drawScore=this.drawScore+(~~((this.score-this.drawScore)/5)+1))},e}();__reflect(StatusClass.prototype,"StatusClass");var Status=new StatusClass,GameMode;!function(e){e[e.Puzzle=0]="Puzzle",e[e.Score=1]="Score",e[e.Score30=2]="Score30",e[e.Score1M=3]="Score1M",e[e.ScoreCombo=4]="ScoreCombo"}(GameMode||(GameMode={}));var InputClearClass=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(Input);__reflect(InputClearClass.prototype,"InputClearClass");var InputClear=new InputClearClass,InputOption=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(Input);__reflect(InputOption.prototype,"InputOption");var InputPuzzleSelectClass=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.mouseDownEvent=function(e){var t=SharedManager.getCurPuzzle();if(SceneManager.scene instanceof PuzzleSelectScene){var n=SceneManager.scene,a=egret.Point.create(e.stageX,e.stageY);if(n.stageGroup.getTransformedBounds(this).containsPoint(a)){var o=e.stageX-n.stageGroup.x,r=e.stageY-n.stageGroup.y;o/=122,r/=140;var i=5*~~r+~~o;(i>24||0>i)&&(i=0),t>=i&&SceneManager.newScene(new SetPuzzleScene(StageManager.getStage(i)))}else n.backImg.getTransformedBounds(this).containsPoint(a)&&SceneManager.newScene(new SelectScene)}},t.prototype.mouseUpEvent=function(e){},t.prototype.mouseOutEvent=function(e){},t}(Input);__reflect(InputPuzzleSelectClass.prototype,"InputPuzzleSelectClass");var InputPuzzleSelect=new InputPuzzleSelectClass,InputRankingClass=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.mouseDownEvent=function(e){e.stageY>=1e3&&e.stageX>=256&&e.stageX<=366&&App.BackMenu.updateStart()},t.prototype.mouseUpEvent=function(e){App.BackMenu.updateFinish()},t}(Input);__reflect(InputRankingClass.prototype,"InputRankingClass");var InputRanking=new InputRankingClass,InputSelectClass=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.mouseDownEvent=function(e){if(SceneManager.scene instanceof SelectScene){var t=SceneManager.scene,n=egret.Point.create(e.stageX,e.stageY);t.puzzleGroup.getTransformedBounds(this).containsPoint(n)?SceneManager.newScene(new PuzzleSelectScene):t.scoreGroup.getTransformedBounds(this).containsPoint(n)?SceneManager.newScene(new SetScoreScene):t.score30Group.getTransformedBounds(this).containsPoint(n)?SceneManager.newScene(new SetScore30Scene):t.score1m.getTransformedBounds(this).containsPoint(n)?SceneManager.newScene(new SetScore1minScene):t.rankGroup.getTransformedBounds(this).containsPoint(n)?SceneManager.newScene(new RankingScene):t.optionGroup.getTransformedBounds(this).containsPoint(n)||t.comboGroup.getTransformedBounds(this).containsPoint(n)&&SceneManager.newScene(new SetScore1comboScene)}},t}(Input);__reflect(InputSelectClass.prototype,"InputSelectClass");var InputSelect=new InputSelectClass,InputSetPuzzleClass=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.mouseDownEvent=function(e){if(this.blockRect=new egret.Rectangle(BlockManager.x,BlockManager.y,BlockManager.width,BlockManager.height),this.blockRect.containsPoint(egret.Point.create(e.stageX,e.stageY))){var t=~~((e.stageX-this.blockRect.x)/120);BlockManager.mouseX=e.stageX,BlockManager.mouseY=e.stageY,BlockManager.mouseDownInventory(t)}else e.stageY>=1e3&&e.stageX>=130&&e.stageX<=240?App.BackMenu.updateStart():e.stageY>=1e3&&e.stageX>=410&&e.stageX<=520&&BlockManager.undo()},t.prototype.mouseMoveEvent=function(e){BlockManager.mouseX=e.stageX,BlockManager.mouseY=e.stageY},t.prototype.mouseUpEvent=function(e){if(App.BackMenu.updateFinish(),BlockManager.mouseDownBlock)if(InputSetPuzzle.fieldRect=new egret.Rectangle(this.field.x,this.field.y,this.field.width,this.field.height),this.fieldRect.containsPoint(egret.Point.create(e.stageX,e.stageY))){console.log("containsPoint");var t=~~(e.stageX-this.field.x)/120,n=~~(e.stageY-this.field.y)/120;this.field.mouseUpField(~~n,~~t)}else BlockManager.mouseUp()},t.prototype.mouseOutEvent=function(e){if(SceneManager.scene instanceof SetPuzzleScene)if(this.fieldRect.containsPoint(egret.Point.create(e.stageX,e.stageY))){var t=(e.stageX-this.field.x)/120,n=(e.stageY-this.field.y)/120;this.field.mouseUpField(t,n)}else BlockManager.mouseUp()},t}(Input);__reflect(InputSetPuzzleClass.prototype,"InputSetPuzzleClass");var InputSetPuzzle=new InputSetPuzzleClass,InputSetScoreClass=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.mouseDownEvent=function(e){if(this.blockRect=new egret.Rectangle(BlockManager.x,BlockManager.y,BlockManager.width,BlockManager.height),this.blockRect.containsPoint(egret.Point.create(e.stageX,e.stageY))){var t=~~((e.stageX-this.blockRect.x)/120);BlockManager.mouseX=e.stageX,BlockManager.mouseY=e.stageY,BlockManager.mouseDownInventory(t),console.log(t)}else e.stageY>=1e3&&e.stageX>=256&&e.stageX<=366&&App.BackMenu.updateStart()},t.prototype.mouseMoveEvent=function(e){BlockManager.mouseX=e.stageX,BlockManager.mouseY=e.stageY},t.prototype.mouseUpEvent=function(e){if(App.BackMenu.updateFinish(),BlockManager.mouseDownBlock)if(this.fieldRect=new egret.Rectangle(this.field.x,this.field.y,this.field.width,this.field.height),this.fieldRect.containsPoint(egret.Point.create(e.stageX,e.stageY))){console.log("containsPoint");var t=~~(e.stageX-this.field.x)/120,n=~~(e.stageY-this.field.y)/120;this.field.mouseUpField(~~n,~~t)}else BlockManager.mouseUp()},t.prototype.mouseOutEvent=function(e){if(SceneManager.scene instanceof SetScoreScene)if(this.fieldRect.containsPoint(egret.Point.create(e.stageX,e.stageY))){var t=(e.stageX-this.field.x)/120,n=(e.stageY-this.field.y)/120;this.field.mouseUpField(t,n)}else BlockManager.mouseUp()},t}(Input);__reflect(InputSetScoreClass.prototype,"InputSetScoreClass");var InputSetScore=new InputSetScoreClass,NameScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(Scene);__reflect(NameScene.prototype,"NameScene");var OptionScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(Scene);__reflect(OptionScene.prototype,"OptionScene");var PuzzleSelectScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="PuzzleSelectSceneSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){InputManager.newInput(InputPuzzleSelect),this.setStageShow()},t.prototype.setStageShow=function(){for(var e=SharedManager.getCurPuzzle(),t=0;t<this.stageGroup.numChildren;t++){var n=this.stageGroup.getChildAt(t),a=0;t===e&&(a=12229450),e>t&&(a=13749452),n.fillColor=a}},t}(Scene);__reflect(PuzzleSelectScene.prototype,"PuzzleSelectScene");var RankingScene=function(e){function t(){var t=e.call(this)||this;return t.isdisplay=!0,t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.disable,t),InputManager.newInput(InputRanking),t}return __extends(t,e),t.prototype.childrenCreated=function(){this.init();var e=Resource.getBlockChips(22,220,22,22);e.width=110,e.height=110,e.x=265,e.y=1e3,this.addChild(e),this.addChild(App.BackMenu)},t.prototype.init=function(){var e=window.platform;this.bitmap=e.openDataContext.createDisplayObject(null,this.stage.stageWidth,this.stage.stageHeight),this.addChild(this.bitmap),e.openDataContext.postMessage({isDisplay:this.isdisplay,keys:["puzzle","score","score30","score1min","score1combo"],year:(new Date).getFullYear(),command:"getFriendCloudStorage"})},t.prototype.update=function(){App.BackMenu.update()},t.prototype.disable=function(){platform.openDataContext.postMessage({isDisplay:!1,keys:["score","score30","score1min","score1combo"],year:(new Date).getFullYear()})},t}(Scene);__reflect(RankingScene.prototype,"RankingScene");var SelectScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="SelectSceneSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){InputManager.newInput(InputSelect),this.score1mLab.text=SharedManager.score1min.toString(),this.scoreLab.text=SharedManager.score.toString(),this.score30Lab.text=SharedManager.score30.toString(),this.scoreComboLab.text=SharedManager.score1combo.toString(),this.puzzleLab.text=SharedManager.getCurPuzzle().toString()+"/25"},t}(Scene);__reflect(SelectScene.prototype,"SelectScene");var SetPuzzleScene=function(e){function t(t){var n=e.call(this)||this;Status.mode=GameMode.Puzzle,n.addChild(n.field=new Field(t));var a=Resource.getBlockChips(0,220,22,22);a.width=110,a.height=110,a.x=410,a.y=1e3,n.addChild(a),n.undoBmd=a;var o=Resource.getBlockChips(22,220,22,22);return o.width=110,o.height=110,o.x=130,o.y=1e3,n.addChild(o),n.addChild(BlockManager),n.addChild(n.hudManager=new HudManagerScore),n.addChild(EffectManager),InputSetPuzzle.field=n.field,InputSetPuzzle.fieldRect=new egret.Rectangle(n.field.x,n.field.y,n.field.width,n.field.height),InputSetPuzzle.blockRect=new egret.Rectangle(BlockManager.x,BlockManager.y,BlockManager.width,BlockManager.height),InputManager.newInput(InputSetPuzzle),n.addChild(App.BackMenu),n.hudManager.stageNOLab.text=t.stageNo.toString(),n}return __extends(t,e),t.prototype.update=function(){BlockManager.update(),EffectManager.update(),App.BackMenu.update(),Status.update(),this.hudManager.update()},t}(Scene);__reflect(SetPuzzleScene.prototype,"SetPuzzleScene");var SetScore1comboScene=function(e){function t(){var t=e.call(this)||this;Status.mode=GameMode.ScoreCombo,t.addChild(t.field=new Field(new StageData("0,0,ScoreAttack,5,4,11111111111111111111")));var n=Resource.getBlockChips(22,220,22,22);return n.width=110,n.height=110,n.x=265,n.y=1e3,t.addChild(n),BlockManager.addRandomInventoryBlock(0),BlockManager.addRandomInventoryBlock(1),BlockManager.addRandomInventoryBlock(2),BlockManager.addRandomInventoryBlock(3),BlockManager.addRandomInventoryBlock(4),t.addChild(BlockManager),t.addChild(t.hudManager=new HudManagerScore),t.addChild(App.BackMenu),t.addChild(EffectManager),InputManager.newInput(InputSetScore),InputSetScore.field=t.field,t}return __extends(t,e),t.prototype.update=function(){BlockManager.update(),EffectManager.update(),App.BackMenu.update(),Status.update(),this.hudManager.update()},t.isFinish=!1,t}(Scene);__reflect(SetScore1comboScene.prototype,"SetScore1comboScene");var SetScore1minScene=function(e){function t(){var t=e.call(this)||this;Status.mode=GameMode.Score1M,t.addChild(t.field=new Field(new StageData("0,0,ScoreAttack,3,3,111111111")));var n=Resource.getBlockChips(22,220,22,22);return n.width=110,n.height=110,n.x=265,n.y=1e3,t.addChild(n),BlockManager.addRandomInventoryBlock(0),BlockManager.addRandomInventoryBlock(1),BlockManager.addRandomInventoryBlock(2),t.addChild(BlockManager),t.addChild(t.hudManager=new HudManagerScore),t.addChild(App.BackMenu),t.addChild(EffectManager),InputManager.newInput(InputSetScore),InputSetScore.field=t.field,InputManager.addChild(new CountDownSprite),t}return __extends(t,e),t.prototype.update=function(){t.isFinish||t.cnt++,t.isFinish&&null==this.field.matchingJob&&t.cnt>=1800&&(t.isFinish=!0,BlockManager.finish(t)),BlockManager.update(),EffectManager.update(),App.BackMenu.update(),Status.update(),this.hudManager.update()},t.isFinish=!1,t}(Scene);__reflect(SetScore1minScene.prototype,"SetScore1minScene");var SetScore30Scene=function(e){function t(){var t=e.call(this)||this;Status.mode=GameMode.Score30,t.addChild(t.field=new Field(new StageData("0,0,ScoreAttack,3,3,111111111")));var n=Resource.getBlockChips(22,220,22,22);return n.width=110,n.height=110,n.x=265,n.y=1e3,t.addChild(n),BlockManager.addRandomInventoryBlock(0),BlockManager.addRandomInventoryBlock(1),BlockManager.addRandomInventoryBlock(2),t.addChild(BlockManager),t.addChild(t.hudManager=new HudManagerScore),t.addChild(App.BackMenu),t.addChild(EffectManager),InputManager.newInput(InputSetScore),InputSetScore.field=t.field,t}return __extends(t,e),t.prototype.update=function(){BlockManager.update(),EffectManager.update(),App.BackMenu.update(),Status.update(),this.hudManager.update()},t.isFinish=!1,t}(Scene);__reflect(SetScore30Scene.prototype,"SetScore30Scene");var SetScoreScene=function(e){function t(){var t=e.call(this)||this;Status.mode=GameMode.Score,t.addChild(t.field=new Field(new StageData("0,0,ScoreAttack,3,3,111111111")));var n=Resource.getBlockChips(22,220,22,22);return n.width=110,n.height=110,n.x=265,n.y=1e3,t.addChild(n),BlockManager.addRandomInventoryBlock(0),BlockManager.addRandomInventoryBlock(1),BlockManager.addRandomInventoryBlock(2),t.addChild(BlockManager),t.addChild(t.hudManager=new HudManagerScore),t.addChild(App.BackMenu),t.addChild(EffectManager),InputManager.newInput(InputSetScore),InputSetScore.field=t.field,t}return __extends(t,e),t.prototype.update=function(){BlockManager.update(),EffectManager.update(),App.BackMenu.update(),Status.update(),this.hudManager.update()},t}(Scene);__reflect(SetScoreScene.prototype,"SetScoreScene");var TitleScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.next=function(){SceneManager.newScene(new SelectScene)},t}(Scene);__reflect(TitleScene.prototype,"TitleScene"),window.Main=Main;