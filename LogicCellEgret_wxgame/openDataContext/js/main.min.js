var egret=window.egret,__reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},Button=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.drawRect=function(e,t,n){this.graphics.lineStyle(1,16777215),this.graphics.beginFill(e),this.graphics.drawRect(0,0,t,n),this.graphics.endFill()},t.prototype.setText=function(e){var t=new egret.TextField;t.size=26,t.text=e,this.addChild(t)},t}(egret.Sprite);__reflect(Button.prototype,"Button");var Main=function(e){function t(){var t=e.call(this)||this;t.scrollView=new egret.ScrollView,t.gameData=[],wx.onMessage(function(e){console.log(e),e.isDisplay?wx.getFriendCloudStorage({keyList:e.keys,success:function(e){console.log(e),t.gameData=e.data,t.runGame()},fail:function(e){console.log(e)},complete:function(){}}):t.cancelGame()});var n=new egret.ImageLoader;n.addEventListener(egret.Event.COMPLETE,function(e){var n=e.currentTarget;t.bgtexture=new egret.Texture,t.bgtexture._setBitmapData(n.data)},t),n.load("resource/assets/panel_shop_01.png");var r=new egret.ImageLoader;return r.addEventListener(egret.Event.COMPLETE,function(e){var n=e.currentTarget;t.panel_01=new egret.Texture,t.panel_01._setBitmapData(n.data)},t),r.load("resource/assets/panel_bg.png"),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){console.log("子域输出点击")},t),t}return __extends(t,e),t.prototype.runGame=function(){console.log("runGame opendata");var e=new Button;e.drawRect(0,600,1e3),e.x=640-e.width>>1,this.addChild(e);var t=new egret.DisplayObjectContainer;this.scrollView.setContent(t),this.scrollView.x=e.x,this.scrollView.y=e.y+100,this.scrollView.width=e.width,this.scrollView.height=e.height-100,this.addChild(this.scrollView),this.gameData.forEach(function(e,n){var r=new egret.DisplayObjectContainer;r.y=130*n,r.x=10,t.addChild(r);var a=new Button;a.drawRect(986895,580,113),r.addChild(a);var i=new MyImage;i.y=20,i.x=20,i.setSrc(e.avatarUrl),i.scaleX=.6,i.scaleY=.6,r.addChild(i);var o=new egret.TextField;o.size=26,o.y=50,o.x=120,o.text="名字: "+e.nickname,r.addChild(o);var s=new egret.TextField;s.size=26,s.x=400,s.y=50,s.text="当前第: "+e.KVDataList[0].value+"关",r.addChild(s)},this)},t.prototype.cancelGame=function(){for(var e=0,t=this.numChildren;t>e;e++)this.removeChildAt(0);this.scrollView.removeContent(),console.log("停止开放数据域")},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var MyImage=function(e){function t(){var t=e.call(this)||this;return t.imageLoader=new egret.ImageLoader,t.imageLoader.addEventListener(egret.Event.COMPLETE,function(e){var n=e.currentTarget,r=new egret.Texture;r._setBitmapData(n.data),t.texture=r},t),t}return __extends(t,e),t.prototype.setSrc=function(e){this.imageLoader.load(e)},t}(egret.Bitmap);__reflect(MyImage.prototype,"MyImage"),window.Main=Main;